(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{M:()=>z});var e=function(t){return fetch("https://nomoreparties.co/v1/plus-cohort-21/cards/".concat(t),{method:"DELETE",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37"}}).then(q)},o=function(t){return fetch("https://nomoreparties.co/v1/plus-cohort-21/cards/likes/".concat(t),{method:"PUT",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37","Content-Type":"application/json"}}).then(q)},n=function(t){return fetch("https://nomoreparties.co/v1/plus-cohort-21/cards/likes/".concat(t),{method:"DELETE",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37","Content-Type":"application/json"}}).then(q)},r=document.querySelector("#saved-profil"),c=document.querySelector("#name-surname"),a=document.querySelector("#about-me"),i=document.querySelector("#new-post"),u=document.querySelector("#post-name"),s=document.querySelector("#post-link"),l=document.querySelector(".popup_add-post"),d=document.querySelector("#new-avatar"),p=document.querySelector("#avatar-link");function m(t){t.classList.remove("popup_opened"),t.removeEventListener("click",f),document.removeEventListener("keydown",v)}function f(t){var e=t.currentTarget,o=t.target;(o.classList.contains("popup")||o.classList.contains("popup__close"))&&m(e)}function v(t){"Escape"===t.key&&m(document.querySelector(".popup_opened"))}function h(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Сохранить",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Сохранение...";e.textContent=t?n:o}r.addEventListener("submit",(function(t){var e,o;t.preventDefault(),h(!0,t.submitter),(e=c.value.trim(),o=a.value.trim(),fetch("https://nomoreparties.co/v1/plus-cohort-21/users/me",{method:"PATCH",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37","Content-Type":"application/json"},body:JSON.stringify({name:e,about:o})}).then(q)).then((function(t){!function(t){y.textContent=t.name,_.textContent=t.about}(t),m(b)})).catch((function(t){console.log(t)})).finally((function(){h(!1,t.submitter)}))})),i.addEventListener("submit",(function(t){t.preventDefault();var e,o,n=u.value.trim(),r=s.value.trim();h(!0,t.submitter),(e=n,o=r,fetch("https://nomoreparties.co/v1/plus-cohort-21/cards ",{method:"POST",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37","Content-Type":"application/json"},body:JSON.stringify({name:e,link:o})}).then(q)).then((function(t){var e=t.link,o=t.name,n=t.likes.length,r=t.owner._id,c=t._id;T(e,o,n,z,r,c),m(l)})).catch((function(t){console.log(t)})).finally((function(){h(!1,t.submitter)}))})),d.addEventListener("submit",(function(t){t.preventDefault();var e=p.value.trim();h(!0,t.submitter),function(t){return fetch("https://nomoreparties.co/v1/plus-cohort-21/users/me/avatar ",{method:"PATCH",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37","Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then(q)}(e).then((function(t){var e;e=t.avatar,S.src=e,m(g)})).catch((function(t){console.log(t)})).finally((function(){h(!1,t.submitter)}))}));var y=document.querySelector(".profile__name"),_=document.querySelector(".profile__description"),b=document.querySelector(".popup_edit-profile"),S=document.querySelector(".profile__avatar"),g=document.querySelector(".popup_add-avatar");function E(t){t.classList.add("popup_opened"),t.addEventListener("click",f),document.addEventListener("keydown",v)}function q(t){return t.ok?t.json():Promise.reject("Ошибка ".concat(t.status))}var L=document.querySelector("#template-post").content,k=document.querySelector(".posts__list"),C=document.querySelector(".popup_zoom-image"),x=document.querySelector(".popup__zoom-image"),A=document.querySelector(".popup__zoom-description");function T(t,r,c,a,i,u){var s=function(t,r,c,a,i,u,s){var l=L.querySelector(".post").cloneNode(!0),d=l.querySelector(".post__like"),p=l.querySelector(".post__image"),m=l.querySelector(".post__trash"),f=l.querySelector(".post__name"),v=l.querySelector(".post__like-count");return s&&d.classList.add("post__like_active"),a==i?(m.setAttribute("data-card-Id",u),m.addEventListener("click",(function(){!function(t){var o=t.getAttribute("data-card-Id");e(o).then((function(){t.closest(".post").remove()})).catch((function(t){console.log(t)}))}(m)}))):m.remove(),p.src=t,p.alt=r,f.textContent=r,v.textContent=c,d.setAttribute("data-card-Id",u),d.addEventListener("click",(function(){!function(t,e,r){t.classList.contains("post__like_active")?n(e).then((function(e){r.textContent=e.likes.length,t.classList.toggle("post__like_active")})).catch((function(t){console.log(t)})):o(e).then((function(e){r.textContent=e.likes.length,t.classList.toggle("post__like_active")})).catch((function(t){console.log(t)}))}(d,u,v)})),p.addEventListener("click",(function(){!function(t,e){x.src=t.getAttribute("src"),x.alt=e,A.textContent=e,E(C)}(p,r)})),l}(t,r,c,a,i,u,arguments.length>6&&void 0!==arguments[6]&&arguments[6]);k.prepend(s)}var j=function(t,e,o){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!1,e.classList.remove(o.buttonDisabled)):(e.disabled=!0,e.classList.add(o.buttonDisabled))};function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var z="";Promise.all([fetch("https://nomoreparties.co/v1/plus-cohort-21/users/me",{method:"GET",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37"}}).then(q),fetch("https://nomoreparties.co/v1/plus-cohort-21/cards",{method:"GET",headers:{authorization:"00d0c259-9510-40e2-8a54-40ce9400cb37"}}).then(q)]).then((function(t){var e,o,n=(o=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var n,r,c,a,i=[],u=!0,s=!1;try{if(c=(o=o.call(t)).next,0===e){if(Object(o)!==o)return;u=!1}else for(;!(u=(n=c.call(o)).done)&&(i.push(n.value),i.length!==e);u=!0);}catch(t){s=!0,r=t}finally{try{if(!u&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(s)throw r}}return i}}(e,o)||function(t,e){if(t){if("string"==typeof t)return w(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?w(t,e):void 0}}(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=n[0],c=n[1];y.textContent=r.name,_.textContent=r.about,S.src=r.avatar,z=r._id,function(t){t.reverse().forEach((function(t){var e=t.link,o=t.name,n=t.likes,r=t.owner._id,c=t._id;T(e,o,n.length,z,r,c,function(t){var e=!1;return t.forEach((function(t){t._id===z&&(e=!0)})),e}(n))}))}(c)})).catch((function(t){console.log(t)}));var O,D=document.querySelector(".profile__edit"),P=document.querySelector(".profile__add-post");document.querySelector(".profile__add-avatar").addEventListener("click",(function(){d.reset(),E(g)})),D.addEventListener("click",(function(){var t,e;t=y,e=_,c.value=t.textContent.trim(),a.value=e.textContent.trim(),E(b)})),P.addEventListener("click",(function(){i.reset(),E(l)})),O={form:".popup__form",input:".popup__input-text",inputError:"popup__input-text_error",messageError:"popup__message-error_active",button:".popup__button-submit",buttonDisabled:"popup__button-submit_disabled"},Array.from(document.querySelectorAll(O.form)).forEach((function(t){!function(t,e){var o=Array.from(t.querySelectorAll(e.input)),n=t.querySelector(e.button);j(o,n,e),o.forEach((function(r){r.addEventListener("input",(function(){!function(t,e,o){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?function(t,e,o){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(o.inputError),n.classList.remove(o.messageError),n.textContent=""}(t,e,o):function(t,e,o,n){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(n.inputError),r.textContent=o,r.classList.add(n.messageError)}(t,e,e.validationMessage,o)}(t,r,e),j(o,n,e)}))})),t.addEventListener("reset",(function(){setTimeout((function(){j(o,n,e)}))}))}(t,O)}))})();